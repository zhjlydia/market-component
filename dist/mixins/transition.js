export const transition = function (showDefaultValue) {
  return Behavior({
    properties: {
      customStyle: String,
      show: {
        type: Boolean,
        value: showDefaultValue,
        observer: 'observeShow'
      },
      duration: {
        type: Number,
        value: 300
      }
    },
    data: {
      type: '',
      inited: false,
      display: false,
      supportAnimation: true
    },

    attached() {
      if (this.data.show) {
        this.show();
      }

      this.detectSupport();
    },

    methods: {
      detectSupport() {
        wx.getSystemInfo({
          success: info => {
            if (info && info.system && info.system.indexOf('iOS 8') === 0) {
              this.set({
                supportAnimation: false
              });
            }
          }
        });
      },

      observeShow(value) {
        if (value) {
          this.show();
        } else {
          if (this.data.supportAnimation) {
            this.set({
              type: 'leave'
            });
          } else {
            this.set({
              display: false
            });
          }
        }
      },

      show() {
        this.set({
          inited: true,
          display: true,
          type: 'enter'
        });
      },

      onAnimationEnd() {
        if (!this.data.show) {
          this.set({
            display: false
          });
        }
      }

    }
  });
};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1peGlucy90cmFuc2l0aW9uLnRzIl0sIm5hbWVzIjpbInRyYW5zaXRpb24iLCJzaG93RGVmYXVsdFZhbHVlIiwiQmVoYXZpb3IiLCJwcm9wZXJ0aWVzIiwiY3VzdG9tU3R5bGUiLCJTdHJpbmciLCJzaG93IiwidHlwZSIsIkJvb2xlYW4iLCJ2YWx1ZSIsIm9ic2VydmVyIiwiZHVyYXRpb24iLCJOdW1iZXIiLCJkYXRhIiwiaW5pdGVkIiwiZGlzcGxheSIsInN1cHBvcnRBbmltYXRpb24iLCJhdHRhY2hlZCIsImRldGVjdFN1cHBvcnQiLCJtZXRob2RzIiwid3giLCJnZXRTeXN0ZW1JbmZvIiwic3VjY2VzcyIsImluZm8iLCJzeXN0ZW0iLCJpbmRleE9mIiwic2V0Iiwib2JzZXJ2ZVNob3ciLCJvbkFuaW1hdGlvbkVuZCJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxNQUFNQSxVQUFVLEdBQUcsVUFBU0MsZ0JBQVQsRUFBeUI7QUFDakQsU0FBT0MsUUFBUSxDQUFDO0FBQ2RDLElBQUFBLFVBQVUsRUFBRTtBQUNWQyxNQUFBQSxXQUFXLEVBQUVDLE1BREg7QUFFVkMsTUFBQUEsSUFBSSxFQUFFO0FBQ0pDLFFBQUFBLElBQUksRUFBRUMsT0FERjtBQUVKQyxRQUFBQSxLQUFLLEVBQUVSLGdCQUZIO0FBR0pTLFFBQUFBLFFBQVEsRUFBRTtBQUhOLE9BRkk7QUFPVkMsTUFBQUEsUUFBUSxFQUFFO0FBQ1JKLFFBQUFBLElBQUksRUFBRUssTUFERTtBQUVSSCxRQUFBQSxLQUFLLEVBQUU7QUFGQztBQVBBLEtBREU7QUFjZEksSUFBQUEsSUFBSSxFQUFFO0FBQ0pOLE1BQUFBLElBQUksRUFBRSxFQURGO0FBRUpPLE1BQUFBLE1BQU0sRUFBRSxLQUZKO0FBR0pDLE1BQUFBLE9BQU8sRUFBRSxLQUhMO0FBSUpDLE1BQUFBLGdCQUFnQixFQUFFO0FBSmQsS0FkUTs7QUFxQmRDLElBQUFBLFFBQVEsR0FBQTtBQUNOLFVBQUksS0FBS0osSUFBTCxDQUFVUCxJQUFkLEVBQW9CO0FBQ2xCLGFBQUtBLElBQUw7QUFDRDs7QUFFRCxXQUFLWSxhQUFMO0FBQ0QsS0EzQmE7O0FBNkJkQyxJQUFBQSxPQUFPLEVBQUU7QUFDUEQsTUFBQUEsYUFBYSxHQUFBO0FBQ1hFLFFBQUFBLEVBQUUsQ0FBQ0MsYUFBSCxDQUFpQjtBQUNmQyxVQUFBQSxPQUFPLEVBQUVDLElBQUksSUFBRztBQUNkLGdCQUFJQSxJQUFJLElBQUlBLElBQUksQ0FBQ0MsTUFBYixJQUF1QkQsSUFBSSxDQUFDQyxNQUFMLENBQVlDLE9BQVosQ0FBb0IsT0FBcEIsTUFBaUMsQ0FBNUQsRUFBK0Q7QUFDN0QsbUJBQUtDLEdBQUwsQ0FBUztBQUFFVixnQkFBQUEsZ0JBQWdCLEVBQUU7QUFBcEIsZUFBVDtBQUNEO0FBQ0Y7QUFMYyxTQUFqQjtBQU9ELE9BVE07O0FBV1BXLE1BQUFBLFdBQVcsQ0FBQ2xCLEtBQUQsRUFBTTtBQUNmLFlBQUlBLEtBQUosRUFBVztBQUNULGVBQUtILElBQUw7QUFDRCxTQUZELE1BRU87QUFDTCxjQUFJLEtBQUtPLElBQUwsQ0FBVUcsZ0JBQWQsRUFBZ0M7QUFDOUIsaUJBQUtVLEdBQUwsQ0FBUztBQUFFbkIsY0FBQUEsSUFBSSxFQUFFO0FBQVIsYUFBVDtBQUNELFdBRkQsTUFFTztBQUNMLGlCQUFLbUIsR0FBTCxDQUFTO0FBQUVYLGNBQUFBLE9BQU8sRUFBRTtBQUFYLGFBQVQ7QUFDRDtBQUNGO0FBQ0YsT0FyQk07O0FBdUJQVCxNQUFBQSxJQUFJLEdBQUE7QUFDRixhQUFLb0IsR0FBTCxDQUFTO0FBQ1BaLFVBQUFBLE1BQU0sRUFBRSxJQUREO0FBRVBDLFVBQUFBLE9BQU8sRUFBRSxJQUZGO0FBR1BSLFVBQUFBLElBQUksRUFBRTtBQUhDLFNBQVQ7QUFLRCxPQTdCTTs7QUErQlBxQixNQUFBQSxjQUFjLEdBQUE7QUFDWixZQUFJLENBQUMsS0FBS2YsSUFBTCxDQUFVUCxJQUFmLEVBQXFCO0FBQ25CLGVBQUtvQixHQUFMLENBQVM7QUFDUFgsWUFBQUEsT0FBTyxFQUFFO0FBREYsV0FBVDtBQUdEO0FBQ0Y7O0FBckNNO0FBN0JLLEdBQUQsQ0FBZjtBQXFFRCxDQXRFTSIsImZpbGUiOiJtaXhpbnMvdHJhbnNpdGlvbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjb25zdCB0cmFuc2l0aW9uID0gZnVuY3Rpb24oc2hvd0RlZmF1bHRWYWx1ZSkge1xyXG4gIHJldHVybiBCZWhhdmlvcih7XHJcbiAgICBwcm9wZXJ0aWVzOiB7XHJcbiAgICAgIGN1c3RvbVN0eWxlOiBTdHJpbmcsXHJcbiAgICAgIHNob3c6IHtcclxuICAgICAgICB0eXBlOiBCb29sZWFuLFxyXG4gICAgICAgIHZhbHVlOiBzaG93RGVmYXVsdFZhbHVlLFxyXG4gICAgICAgIG9ic2VydmVyOiAnb2JzZXJ2ZVNob3cnXHJcbiAgICAgIH0sXHJcbiAgICAgIGR1cmF0aW9uOiB7XHJcbiAgICAgICAgdHlwZTogTnVtYmVyLFxyXG4gICAgICAgIHZhbHVlOiAzMDBcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICBkYXRhOiB7XHJcbiAgICAgIHR5cGU6ICcnLFxyXG4gICAgICBpbml0ZWQ6IGZhbHNlLFxyXG4gICAgICBkaXNwbGF5OiBmYWxzZSxcclxuICAgICAgc3VwcG9ydEFuaW1hdGlvbjogdHJ1ZVxyXG4gICAgfSxcclxuXHJcbiAgICBhdHRhY2hlZCgpIHtcclxuICAgICAgaWYgKHRoaXMuZGF0YS5zaG93KSB7XHJcbiAgICAgICAgdGhpcy5zaG93KCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMuZGV0ZWN0U3VwcG9ydCgpO1xyXG4gICAgfSxcclxuXHJcbiAgICBtZXRob2RzOiB7XHJcbiAgICAgIGRldGVjdFN1cHBvcnQoKSB7XHJcbiAgICAgICAgd3guZ2V0U3lzdGVtSW5mbyh7XHJcbiAgICAgICAgICBzdWNjZXNzOiBpbmZvID0+IHtcclxuICAgICAgICAgICAgaWYgKGluZm8gJiYgaW5mby5zeXN0ZW0gJiYgaW5mby5zeXN0ZW0uaW5kZXhPZignaU9TIDgnKSA9PT0gMCkge1xyXG4gICAgICAgICAgICAgIHRoaXMuc2V0KHsgc3VwcG9ydEFuaW1hdGlvbjogZmFsc2UgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIG9ic2VydmVTaG93KHZhbHVlKSB7XHJcbiAgICAgICAgaWYgKHZhbHVlKSB7XHJcbiAgICAgICAgICB0aGlzLnNob3coKTtcclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgaWYgKHRoaXMuZGF0YS5zdXBwb3J0QW5pbWF0aW9uKSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KHsgdHlwZTogJ2xlYXZlJyB9KTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuc2V0KHsgZGlzcGxheTogZmFsc2UgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9LFxyXG5cclxuICAgICAgc2hvdygpIHtcclxuICAgICAgICB0aGlzLnNldCh7XHJcbiAgICAgICAgICBpbml0ZWQ6IHRydWUsXHJcbiAgICAgICAgICBkaXNwbGF5OiB0cnVlLFxyXG4gICAgICAgICAgdHlwZTogJ2VudGVyJ1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgb25BbmltYXRpb25FbmQoKSB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRhdGEuc2hvdykge1xyXG4gICAgICAgICAgdGhpcy5zZXQoe1xyXG4gICAgICAgICAgICBkaXNwbGF5OiBmYWxzZVxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfSk7XHJcbn07XHJcbiJdfQ==
