import { SpuiComponent } from '../common/component';
SpuiComponent({
  classes: ['active-class', 'toolbar-class', 'column-class'],
  props: {
    title: String,
    loading: Boolean,
    showToolbar: Boolean,
    confirmButtonText: String,
    cancelButtonText: String,
    visibleItemCount: {
      type: Number,
      value: 5
    },
    valueKey: {
      type: String,
      value: 'text'
    },
    itemHeight: {
      type: Number,
      value: 44
    },
    columns: {
      type: Array,
      value: [],

      observer(columns = []) {
        this.set({
          simple: columns.length && !columns[0].values
        }, () => {
          const children = this.children = this.selectAllComponents('.spui-picker__column');

          if (Array.isArray(children) && children.length) {
            this.setColumns();
          }
        });
      }

    }
  },
  methods: {
    noop() {},

    setColumns() {
      const {
        data
      } = this;
      const columns = data.simple ? [{
        values: data.columns
      }] : data.columns;
      columns.forEach((columns, index) => {
        this.setColumnValues(index, columns.values);
      });
    },

    emit(event) {
      const {
        type
      } = event.currentTarget.dataset;

      if (this.data.simple) {
        this.$emit(type, {
          value: this.getColumnValue(0),
          index: this.getColumnIndex(0)
        });
      } else {
        this.$emit(type, {
          value: this.getValues(),
          index: this.getIndexes()
        });
      }
    },

    onChange(event) {
      if (this.data.simple) {
        this.$emit('change', {
          picker: this,
          value: this.getColumnValue(0),
          index: this.getColumnIndex(0)
        });
      } else {
        this.$emit('change', {
          picker: this,
          value: this.getValues(),
          index: event.currentTarget.dataset.index
        });
      }
    },

    // get column instance by index
    getColumn(index) {
      return this.children[index];
    },

    // get column value by index
    getColumnValue(index) {
      const column = this.getColumn(index);
      return column && column.getValue();
    },

    // set column value by index
    setColumnValue(index, value) {
      const column = this.getColumn(index);
      column && column.setValue(value);
    },

    // get column option index by column index
    getColumnIndex(columnIndex) {
      return (this.getColumn(columnIndex) || {}).data.currentIndex;
    },

    // set column option index by column index
    setColumnIndex(columnIndex, optionIndex) {
      const column = this.getColumn(columnIndex);
      column && column.setIndex(optionIndex);
    },

    // get options of column by index
    getColumnValues(index) {
      return (this.children[index] || {}).data.options;
    },

    // set options of column by index
    setColumnValues(index, options) {
      const column = this.children[index];

      if (column && JSON.stringify(column.data.options) !== JSON.stringify(options)) {
        column.set({
          options
        }, () => {
          column.setIndex(0);
        });
      }
    },

    // get values of all columns
    getValues() {
      return this.children.map(child => child.getValue());
    },

    // set values of all columns
    setValues(values) {
      values.forEach((value, index) => {
        this.setColumnValue(index, value);
      });
    },

    // get indexes of all columns
    getIndexes() {
      return this.children.map(child => child.data.currentIndex);
    },

    // set indexes of all columns
    setIndexes(indexes) {
      indexes.forEach((optionIndex, columnIndex) => {
        this.setColumnIndex(columnIndex, optionIndex);
      });
    }

  }
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBpY2tlci9pbmRleC50cyJdLCJuYW1lcyI6WyJTcHVpQ29tcG9uZW50IiwiY2xhc3NlcyIsInByb3BzIiwidGl0bGUiLCJTdHJpbmciLCJsb2FkaW5nIiwiQm9vbGVhbiIsInNob3dUb29sYmFyIiwiY29uZmlybUJ1dHRvblRleHQiLCJjYW5jZWxCdXR0b25UZXh0IiwidmlzaWJsZUl0ZW1Db3VudCIsInR5cGUiLCJOdW1iZXIiLCJ2YWx1ZSIsInZhbHVlS2V5IiwiaXRlbUhlaWdodCIsImNvbHVtbnMiLCJBcnJheSIsIm9ic2VydmVyIiwic2V0Iiwic2ltcGxlIiwibGVuZ3RoIiwidmFsdWVzIiwiY2hpbGRyZW4iLCJzZWxlY3RBbGxDb21wb25lbnRzIiwiaXNBcnJheSIsInNldENvbHVtbnMiLCJtZXRob2RzIiwibm9vcCIsImRhdGEiLCJmb3JFYWNoIiwiaW5kZXgiLCJzZXRDb2x1bW5WYWx1ZXMiLCJlbWl0IiwiZXZlbnQiLCJjdXJyZW50VGFyZ2V0IiwiZGF0YXNldCIsIiRlbWl0IiwiZ2V0Q29sdW1uVmFsdWUiLCJnZXRDb2x1bW5JbmRleCIsImdldFZhbHVlcyIsImdldEluZGV4ZXMiLCJvbkNoYW5nZSIsInBpY2tlciIsImdldENvbHVtbiIsImNvbHVtbiIsImdldFZhbHVlIiwic2V0Q29sdW1uVmFsdWUiLCJzZXRWYWx1ZSIsImNvbHVtbkluZGV4IiwiY3VycmVudEluZGV4Iiwic2V0Q29sdW1uSW5kZXgiLCJvcHRpb25JbmRleCIsInNldEluZGV4IiwiZ2V0Q29sdW1uVmFsdWVzIiwib3B0aW9ucyIsIkpTT04iLCJzdHJpbmdpZnkiLCJtYXAiLCJjaGlsZCIsInNldFZhbHVlcyIsInNldEluZGV4ZXMiLCJpbmRleGVzIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTQSxhQUFULFFBQThCLHFCQUE5QjtBQUVBQSxhQUFhLENBQUM7QUFDWkMsRUFBQUEsT0FBTyxFQUFFLENBQUMsY0FBRCxFQUFpQixlQUFqQixFQUFrQyxjQUFsQyxDQURHO0FBR1pD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QUFDQTRCLElBQUFBLFVBQVUsR0FBQTtBQUNSLGFBQU8sS0FBS2xCLFFBQUwsQ0FBY21DLEdBQWQsQ0FBbUJDLEtBQUQsSUFBNEJBLEtBQUssQ0FBQzlCLElBQU4sQ0FBV3FCLFlBQXpELENBQVA7QUFDRCxLQXhHTTs7QUEwR1A7QUFDQVcsSUFBQUEsVUFBVSxDQUFDQyxPQUFELEVBQWtCO0FBQzFCQSxNQUFBQSxPQUFPLENBQUNoQyxPQUFSLENBQWdCLENBQUNzQixXQUFELEVBQWNILFdBQWQsS0FBNkI7QUFDM0MsYUFBS0UsY0FBTCxDQUFvQkYsV0FBcEIsRUFBaUNHLFdBQWpDO0FBQ0QsT0FGRDtBQUdEOztBQS9HTTtBQXRDRyxDQUFELENBQWIiLCJmaWxlIjoicGlja2VyL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgU3B1aUNvbXBvbmVudCB9IGZyb20gJy4uL2NvbW1vbi9jb21wb25lbnQnO1xyXG5cclxuU3B1aUNvbXBvbmVudCh7XHJcbiAgY2xhc3NlczogWydhY3RpdmUtY2xhc3MnLCAndG9vbGJhci1jbGFzcycsICdjb2x1bW4tY2xhc3MnXSxcclxuXHJcbiAgcHJvcHM6IHtcclxuICAgIHRpdGxlOiBTdHJpbmcsXHJcbiAgICBsb2FkaW5nOiBCb29sZWFuLFxyXG4gICAgc2hvd1Rvb2xiYXI6IEJvb2xlYW4sXHJcbiAgICBjb25maXJtQnV0dG9uVGV4dDogU3RyaW5nLFxyXG4gICAgY2FuY2VsQnV0dG9uVGV4dDogU3RyaW5nLFxyXG4gICAgdmlzaWJsZUl0ZW1Db3VudDoge1xyXG4gICAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICAgIHZhbHVlOiA1XHJcbiAgICB9LFxyXG4gICAgdmFsdWVLZXk6IHtcclxuICAgICAgdHlwZTogU3RyaW5nLFxyXG4gICAgICB2YWx1ZTogJ3RleHQnXHJcbiAgICB9LFxyXG4gICAgaXRlbUhlaWdodDoge1xyXG4gICAgICB0eXBlOiBOdW1iZXIsXHJcbiAgICAgIHZhbHVlOiA0NFxyXG4gICAgfSxcclxuICAgIGNvbHVtbnM6IHtcclxuICAgICAgdHlwZTogQXJyYXksXHJcbiAgICAgIHZhbHVlOiBbXSxcclxuICAgICAgb2JzZXJ2ZXIoY29sdW1ucyA9IFtdKSB7XHJcbiAgICAgICAgdGhpcy5zZXQoe1xyXG4gICAgICAgICAgc2ltcGxlOiBjb2x1bW5zLmxlbmd0aCAmJiAhY29sdW1uc1swXS52YWx1ZXNcclxuICAgICAgICB9LCAoKSA9PiB7XHJcbiAgICAgICAgICBjb25zdCBjaGlsZHJlbiA9IHRoaXMuY2hpbGRyZW4gPSB0aGlzLnNlbGVjdEFsbENvbXBvbmVudHMoJy5zcHVpLXBpY2tlcl9fY29sdW1uJyk7XHJcblxyXG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY2hpbGRyZW4pICYmIGNoaWxkcmVuLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLnNldENvbHVtbnMoKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH0sXHJcblxyXG4gIG1ldGhvZHM6IHtcclxuICAgIG5vb3AoKSB7fSxcclxuXHJcbiAgICBzZXRDb2x1bW5zKCkge1xyXG4gICAgICBjb25zdCB7IGRhdGEgfSA9IHRoaXM7XHJcbiAgICAgIGNvbnN0IGNvbHVtbnMgPSBkYXRhLnNpbXBsZSA/IFt7IHZhbHVlczogZGF0YS5jb2x1bW5zIH1dIDogZGF0YS5jb2x1bW5zO1xyXG4gICAgICBjb2x1bW5zLmZvckVhY2goKGNvbHVtbnMsIGluZGV4OiBudW1iZXIpID0+IHtcclxuICAgICAgICB0aGlzLnNldENvbHVtblZhbHVlcyhpbmRleCwgY29sdW1ucy52YWx1ZXMpO1xyXG4gICAgICB9KTtcclxuICAgIH0sXHJcblxyXG4gICAgZW1pdChldmVudDogV2VhcHAuRXZlbnQpIHtcclxuICAgICAgY29uc3QgeyB0eXBlIH0gPSBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQ7XHJcbiAgICAgIGlmICh0aGlzLmRhdGEuc2ltcGxlKSB7XHJcbiAgICAgICAgdGhpcy4kZW1pdCh0eXBlLCB7XHJcbiAgICAgICAgICB2YWx1ZTogdGhpcy5nZXRDb2x1bW5WYWx1ZSgwKSxcclxuICAgICAgICAgIGluZGV4OiB0aGlzLmdldENvbHVtbkluZGV4KDApXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgdGhpcy4kZW1pdCh0eXBlLCB7XHJcbiAgICAgICAgICB2YWx1ZTogdGhpcy5nZXRWYWx1ZXMoKSxcclxuICAgICAgICAgIGluZGV4OiB0aGlzLmdldEluZGV4ZXMoKVxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG5cclxuICAgIG9uQ2hhbmdlKGV2ZW50OiBXZWFwcC5FdmVudCkge1xyXG4gICAgICBpZiAodGhpcy5kYXRhLnNpbXBsZSkge1xyXG4gICAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZScsIHtcclxuICAgICAgICAgIHBpY2tlcjogdGhpcyxcclxuICAgICAgICAgIHZhbHVlOiB0aGlzLmdldENvbHVtblZhbHVlKDApLFxyXG4gICAgICAgICAgaW5kZXg6IHRoaXMuZ2V0Q29sdW1uSW5kZXgoMClcclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCB7XHJcbiAgICAgICAgICBwaWNrZXI6IHRoaXMsXHJcbiAgICAgICAgICB2YWx1ZTogdGhpcy5nZXRWYWx1ZXMoKSxcclxuICAgICAgICAgIGluZGV4OiBldmVudC5jdXJyZW50VGFyZ2V0LmRhdGFzZXQuaW5kZXhcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBnZXQgY29sdW1uIGluc3RhbmNlIGJ5IGluZGV4XHJcbiAgICBnZXRDb2x1bW4oaW5kZXg6IG51bWJlcikge1xyXG4gICAgICByZXR1cm4gdGhpcy5jaGlsZHJlbltpbmRleF07XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIGdldCBjb2x1bW4gdmFsdWUgYnkgaW5kZXhcclxuICAgIGdldENvbHVtblZhbHVlKGluZGV4OiBudW1iZXIpIHtcclxuICAgICAgY29uc3QgY29sdW1uID0gdGhpcy5nZXRDb2x1bW4oaW5kZXgpO1xyXG4gICAgICByZXR1cm4gY29sdW1uICYmIGNvbHVtbi5nZXRWYWx1ZSgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBzZXQgY29sdW1uIHZhbHVlIGJ5IGluZGV4XHJcbiAgICBzZXRDb2x1bW5WYWx1ZShpbmRleDogbnVtYmVyLCB2YWx1ZTogYW55KSB7XHJcbiAgICAgIGNvbnN0IGNvbHVtbiA9IHRoaXMuZ2V0Q29sdW1uKGluZGV4KTtcclxuICAgICAgY29sdW1uICYmIGNvbHVtbi5zZXRWYWx1ZSh2YWx1ZSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIGdldCBjb2x1bW4gb3B0aW9uIGluZGV4IGJ5IGNvbHVtbiBpbmRleFxyXG4gICAgZ2V0Q29sdW1uSW5kZXgoY29sdW1uSW5kZXg6IG51bWJlcikge1xyXG4gICAgICByZXR1cm4gKHRoaXMuZ2V0Q29sdW1uKGNvbHVtbkluZGV4KSB8fCB7fSkuZGF0YS5jdXJyZW50SW5kZXg7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHNldCBjb2x1bW4gb3B0aW9uIGluZGV4IGJ5IGNvbHVtbiBpbmRleFxyXG4gICAgc2V0Q29sdW1uSW5kZXgoY29sdW1uSW5kZXg6IG51bWJlciwgb3B0aW9uSW5kZXg6IG51bWJlcikge1xyXG4gICAgICBjb25zdCBjb2x1bW4gPSB0aGlzLmdldENvbHVtbihjb2x1bW5JbmRleCk7XHJcbiAgICAgIGNvbHVtbiAmJiBjb2x1bW4uc2V0SW5kZXgob3B0aW9uSW5kZXgpO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBnZXQgb3B0aW9ucyBvZiBjb2x1bW4gYnkgaW5kZXhcclxuICAgIGdldENvbHVtblZhbHVlcyhpbmRleDogbnVtYmVyKSB7XHJcbiAgICAgIHJldHVybiAodGhpcy5jaGlsZHJlbltpbmRleF0gfHwge30pLmRhdGEub3B0aW9ucztcclxuICAgIH0sXHJcblxyXG4gICAgLy8gc2V0IG9wdGlvbnMgb2YgY29sdW1uIGJ5IGluZGV4XHJcbiAgICBzZXRDb2x1bW5WYWx1ZXMoaW5kZXg6IG51bWJlciwgb3B0aW9uczogYW55W10pIHtcclxuICAgICAgY29uc3QgY29sdW1uID0gdGhpcy5jaGlsZHJlbltpbmRleF07XHJcblxyXG4gICAgICBpZiAoXHJcbiAgICAgICAgY29sdW1uICYmXHJcbiAgICAgICAgSlNPTi5zdHJpbmdpZnkoY29sdW1uLmRhdGEub3B0aW9ucykgIT09IEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpXHJcbiAgICAgICkge1xyXG4gICAgICAgIGNvbHVtbi5zZXQoeyBvcHRpb25zIH0sICgpID0+IHtcclxuICAgICAgICAgIGNvbHVtbi5zZXRJbmRleCgwKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuXHJcbiAgICAvLyBnZXQgdmFsdWVzIG9mIGFsbCBjb2x1bW5zXHJcbiAgICBnZXRWYWx1ZXMoKSB7XHJcbiAgICAgIHJldHVybiB0aGlzLmNoaWxkcmVuLm1hcCgoY2hpbGQ6IFdlYXBwLkNvbXBvbmVudCkgPT4gY2hpbGQuZ2V0VmFsdWUoKSk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHNldCB2YWx1ZXMgb2YgYWxsIGNvbHVtbnNcclxuICAgIHNldFZhbHVlcyh2YWx1ZXM6IFtdKSB7XHJcbiAgICAgIHZhbHVlcy5mb3JFYWNoKCh2YWx1ZSwgaW5kZXgpID0+IHtcclxuICAgICAgICB0aGlzLnNldENvbHVtblZhbHVlKGluZGV4LCB2YWx1ZSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSxcclxuXHJcbiAgICAvLyBnZXQgaW5kZXhlcyBvZiBhbGwgY29sdW1uc1xyXG4gICAgZ2V0SW5kZXhlcygpIHtcclxuICAgICAgcmV0dXJuIHRoaXMuY2hpbGRyZW4ubWFwKChjaGlsZDogV2VhcHAuQ29tcG9uZW50KSA9PiBjaGlsZC5kYXRhLmN1cnJlbnRJbmRleCk7XHJcbiAgICB9LFxyXG5cclxuICAgIC8vIHNldCBpbmRleGVzIG9mIGFsbCBjb2x1bW5zXHJcbiAgICBzZXRJbmRleGVzKGluZGV4ZXM6IG51bWJlcltdKSB7XHJcbiAgICAgIGluZGV4ZXMuZm9yRWFjaCgob3B0aW9uSW5kZXgsIGNvbHVtbkluZGV4KSA9PiB7XHJcbiAgICAgICAgdGhpcy5zZXRDb2x1bW5JbmRleChjb2x1bW5JbmRleCwgb3B0aW9uSW5kZXgpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuICB9XHJcbn0pO1xyXG4iXX0=
